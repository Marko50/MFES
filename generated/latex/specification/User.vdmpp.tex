\begin{vdmpp}[breaklines=true]
class User
/*
  Represents a user.
  Defines the variables and operations available to users.
*/
types
  public String = seq of char;
values
instance variables
 private name : String;
 private funds : nat := 0;
 private password : String;
 private events : set of String := {};
 private tickets : set of nat := {};
operations
 -- User constructor, receives Strings for user name and password
(*@
\label{User:17}
@*)
 public User: String * String ==> User
 User(n,p) == (
  name := n;
  password := p;
  return self;
 )
 post name = n and password = p and tickets = {} and events = {};
 
 -- Returns set of Strings representing the names of user's events
(*@
\label{getEvents:26}
@*)
 public pure getEvents : () ==> set of String
 getEvents() == (
  return events;
 );
 
 /*
  Adds an event to user's events set of String
  pre condition checks if event isn't already in set
 */ 
(*@
\label{addEvent:35}
@*)
 public addEvent: String ==> ()
 addEvent(e) == (
  events := events union {e}
 )
 pre e not in set events;
 
 /*
  Removes an event from user's events
  pre condition checks if event is in set
 */ 
(*@
\label{removeEvent:45}
@*)
 public removeEvent : String ==> ()
 removeEvent(e) == (events := events \ {e})
 pre e in set events;
 
 -- Returns user's name
(*@
\label{getName:50}
@*)
 public pure getName : () ==> String
 getName() == (
  return name;
 );
 
 -- Returns user's funds
(*@
\label{getFunds:56}
@*)
 public pure getFunds : () ==> nat
 getFunds() == (
  return funds;
 );
 
 -- Returns user's password
(*@
\label{getPassword:62}
@*)
 public pure getPassword : () ==> String
 getPassword() == (
  return password;
 );
 
(*@
\label{addFunds:67}
@*)
 public addFunds : nat ==> ()
 addFunds(f) == (
  funds := funds + f;
 )
 pre funds + f <= 10000
 post funds = funds~ + f;
 
(*@
\label{removeFunds:74}
@*)
 public removeFunds : nat ==> ()
 removeFunds(f) == (
  funds := funds - f;
 )
 pre funds - f >= 0
 post funds = funds~ - f;
 
(*@
\label{getTickets:81}
@*)
 public pure getTickets : () ==> set of nat
  getTickets() == (
  return tickets;
 );
 
(*@
\label{buyTicket:86}
@*)
 public buyTicket : nat * nat ==> ()
 buyTicket(ticketPrice,t) == (
  removeFunds(ticketPrice);
  addTicket(t);
 );
 
(*@
\label{addTicket:92}
@*)
 public addTicket : nat ==> ()
 addTicket(ticket) == (
  tickets := tickets union {ticket};
 )
 pre ticket not in set tickets
 post tickets = tickets~ union {ticket};
 
(*@
\label{removeTicket:99}
@*)
 public removeTicket : nat ==> ()
 removeTicket(i) == (
  tickets:= tickets \ {i}; 
 )
 pre i in set tickets
 post tickets = tickets~ \ {i}; 
 
functions
traces
end User
\end{vdmpp}
